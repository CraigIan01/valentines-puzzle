<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>For You ðŸ’–</title>

<style>
  body {
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #ffe6eb, #fff);
    display: flex;
    justify-content: center;
    align-items: center;
    min-height: 100vh;
    margin: 0;
  }

  .container {
    text-align: center;
    width: 100%;
    max-width: 420px;
    padding: 16px;
  }

  h1 {
    color: #c9184a;
    margin-bottom: 8px;
  }

  p {
    color: #555;
    margin-top: 0;
  }

  /* Responsive puzzle wrapper */
  .puzzle {
    width: min(90vw, 360px);
    aspect-ratio: 1 / 1;
    margin: 20px auto;
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 2px;
    border-radius: 10px;
    overflow: hidden;
  }

  .piece {
    width: 100%;
    height: 100%;
    background-image: url('puzzle.jpg');
    background-repeat: no-repeat;
    cursor: grab;
  }

  .hidden {
    display: none;
  }

  .button-group {
    margin-top: 20px;
  }

  .button-group button {
    padding: 14px 24px;
    font-size: 16px;
    margin: 8px;
    border: none;
    border-radius: 999px;
    cursor: pointer;
    transition: transform 0.2s ease;
  }

  .button-group button:active {
    transform: scale(0.96);
  }

  .yes {
    background: #ff4d6d;
    color: white;
  }

  .no {
    background: #adb5bd;
    color: white;
  }

  .no.shake {
    animation: shake 0.4s;
  }

  @keyframes shake {
    0% { transform: translateX(0); }
    25% { transform: translateX(-6px); }
    50% { transform: translateX(6px); }
    75% { transform: translateX(-6px); }
    100% { transform: translateX(0); }
  }
</style>
</head>

<body>

<div class="container">
  <h1>Piece by Piece ðŸ’—</h1>
  <p id="subtitle">Put the pieces together.</p>

  <div class="puzzle" id="puzzle"></div>

  <div id="question" class="hidden">
    <h1>Will you be my Valentine? ðŸ’Œ</h1>
    <div class="button-group">
      <button class="yes" onclick="yesClicked()">Yes ðŸ’–</button>
      <button class="no" id="noBtn" onclick="noClicked()">No ðŸ™ƒ</button>
    </div>
  </div>

  <div id="final" class="hidden">
    <h1>Itâ€™s a date ðŸ’•</h1>
    <p>Happy Valentineâ€™s Day.</p>
  </div>
</div>

<script>
  const puzzle = document.getElementById('puzzle');
  const size = 4;
  let draggedPiece = null;

  const positions = [...Array(size * size).keys()];
  positions.sort(() => Math.random() - 0.5);

  function createPuzzle() {
    puzzle.innerHTML = '';

    const puzzleSize = puzzle.clientWidth;
    const pieceSize = puzzleSize / size;

    positions.forEach(pos => {
      const piece = document.createElement('div');
      piece.className = 'piece';
      piece.draggable = true;
      piece.dataset.correct = pos;

      piece.style.backgroundSize = `${puzzleSize}px ${puzzleSize}px`;
      piece.style.backgroundPosition = 
        `-${(pos % size) * pieceSize}px -${Math.floor(pos / size) * pieceSize}px`;

      piece.addEventListener('dragstart', () => draggedPiece = piece);
      piece.addEventListener('dragover', e => e.preventDefault());
      piece.addEventListener('drop', () => swapPieces(piece));

      puzzle.appendChild(piece);
    });
  }

  function swapPieces(target) {
    const draggedNext =
      draggedPiece.nextSibling === target
        ? draggedPiece
        : draggedPiece.nextSibling;

    puzzle.insertBefore(draggedPiece, target);
    puzzle.insertBefore(target, draggedNext);

    checkWin();
  }

  function checkWin() {
    const current = [...puzzle.children];
    const solved = current.every(
      (piece, index) => parseInt(piece.dataset.correct) === index
    );

    if (solved) {
      setTimeout(() => {
        puzzle.classList.add('hidden');
        document.getElementById('subtitle').classList.add('hidden');
        document.getElementById('question').classList.remove('hidden');
      }, 500);
    }
  }

  function noClicked() {
    const noBtn = document.getElementById('noBtn');
    noBtn.classList.add('shake');

    setTimeout(() => {
      noBtn.textContent = 'Yes ðŸ’–';
      noBtn.classList.remove('no');
      noBtn.classList.add('yes');
      noBtn.onclick = yesClicked;
    }, 400);
  }

  function yesClicked() {
    document.getElementById('question').classList.add('hidden');
    document.getElementById('final').classList.remove('hidden');
  }

  // Recalculate on load and resize
  window.addEventListener('load', createPuzzle);
  window.addEventListener('resize', createPuzzle);
</script>

</body>
</html>
